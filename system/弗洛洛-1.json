{
    "id": "e6532df9-c2d2-4337-a0a4-649dc4be7659",
    "scriptName": "弗洛洛对话美化通用",
    "findRegex": "/<fuluoluo\\s+name\\s*=\\s*\"弗洛洛\"\\s+mood\\s*=\\s*\"([^\"]*)\"\\s*>([\\s\\S]*?)<\\/fuluoluo>/gi",
    "replaceString": "<div class=\"fuluoluo-dialogue-v4\" data-mood=\"$1\">\n    <!-- 背景层 (无改动) -->\n    <div style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden;\">\n        <div style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://files.catbox.moe/louf0i.png'); background-size: cover; background-position: center; background-repeat: no-repeat; opacity: 0.2; filter: brightness(0.9) contrast(1.2) sepia(0.2) saturate(0.9); mix-blend-mode: overlay;\"></div>\n        <div style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(165deg, rgba(35, 12, 16, 0.6) 0%, rgba(10, 8, 8, 0.7) 100%); mix-blend-mode: multiply; opacity: 0.3;\"></div>\n    </div>\n    \n    <!-- 头像与文字区域 (无改动) -->\n    <div class=\"fuluoluo-header\">\n        <div class=\"fuluoluo-avatar-placeholder\"></div>\n        <div class=\"fuluoluo-info\">\n            <div class=\"fuluoluo-name\">弗洛洛</div>\n            <div class=\"fuluoluo-divider\"></div>\n            <div class=\"fuluoluo-subtitle\">挽歌永不落幕</div>\n        </div>\n    </div>\n    <div class=\"fuluoluo-body\">\n        <p>$2</p>\n    </div>\n\n    <!-- 彼岸花装饰 -->\n    <div class=\"lycoris-container\">\n        <div class=\"lycoris-flower\"></div>\n        <div class=\"enhanced-breathing-light\"></div>\n        <div class=\"breathing-halo\"></div>\n        <div class=\"breathing-pulse\"></div>\n        <div class=\"enhanced-particle particle-1\"></div>\n        <div class=\"enhanced-particle particle-2\"></div>\n        <div class=\"enhanced-particle particle-3\"></div>\n        <div class=\"enhanced-particle particle-4\"></div>\n        <div class=\"enhanced-particle particle-5\"></div>\n        <div class=\"enhanced-particle particle-6\"></div>\n        <div class=\"enhanced-particle particle-7\"></div>\n    </div>\n</div>\n\n<style>\n/* --- 全局与布局样式 (无改动) --- */\n.fuluoluo-dialogue-v4 {\n    --fuluoluo-base-font-size: 20px; --fuluoluo-avatar-size: 3em; --fuluoluo-padding: 0.8em 1em; --fuluoluo-margin: 1em 0;\n    position: relative; padding: var(--fuluoluo-padding); margin: var(--fuluoluo-margin); font-size: var(--fuluoluo-base-font-size);\n    background: linear-gradient(165deg, rgba(35, 12, 16, 0.97) 0%, rgba(10, 8, 8, 0.98) 100%);\n    border: 1px solid #d10023; border-radius: 6px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), inset 0 0 10px rgba(20, 4, 4, 0.8);\n    backdrop-filter: blur(3px); overflow: hidden; max-width: 100%; box-sizing: border-box; display: flex; flex-direction: column;\n}\n.fuluoluo-dialogue-v4 .fuluoluo-header { display: flex; align-items: center; margin-bottom: 0.6em; z-index: 10; position: relative; flex-shrink: 0; }\n.fuluoluo-dialogue-v4 .fuluoluo-avatar-placeholder { width: var(--fuluoluo-avatar-size); height: var(--fuluoluo-avatar-size); background-size: cover; background-position: center top; border-radius: 4px; border: 1px solid #8b0000; box-shadow: 0 2px 5px rgba(209, 0, 35, 0.4), inset 0 0 4px rgba(139, 0, 0, 0.7); flex-shrink: 0; }\n.fuluoluo-dialogue-v4 .fuluoluo-info { margin-left: 0.75em; display: flex; flex-direction: column; justify-content: center; }\n.fuluoluo-dialogue-v4 .fuluoluo-name { font-family: 'Cormorant Garamond', 'Noto Serif SC', serif; font-size: 1.05em; font-weight: 700; color: #f5f5f0; letter-spacing: 0.5px; text-shadow: 0 0 5px rgba(255, 60, 80, 0.6); line-height: 1.1; }\n.fuluoluo-dialogue-v4 .fuluoluo-divider { height: 1px; background: linear-gradient(90deg, #d10023, transparent); width: 4.5em; margin: 0.2em 0; }\n.fuluoluo-dialogue-v4 .fuluoluo-subtitle { font-family: 'Cormorant Garamond', 'Noto Serif SC', serif; font-size: 0.75em; color: #e0b45d; text-shadow: 0 0 3px rgba(224, 180, 93, 0.5); letter-spacing: 0.2px; line-height: 1.1; }\n.fuluoluo-dialogue-v4 .fuluoluo-body { position: relative; z-index: 5; }\n.fuluoluo-dialogue-v4 .fuluoluo-body p { font-family: 'Quattrocento', 'Source Serif Pro', 'Noto Serif SC', serif; font-style: italic; font-weight: 400; font-size: 1em; line-height: 1.6; color: #f0f0f0; margin: 0; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4); word-break: break-word; text-align: left; }\n\n/* --- CSS 头像映射表 (无改动) --- */\n.fuluoluo-dialogue-v4 .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/n7fryv.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"傲娇\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/vwq5iz.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"害羞\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/oan9x8.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"气愤\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/m17nmc.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"思考\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/v3inmk.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"嫌弃\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/ejklw4.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"演奏\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/40wju1.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"赞许\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/20d68w.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"疯狂\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/69xdyn.png'); }\n.fuluoluo-dialogue-v4[data-mood=\"正常\"] .fuluoluo-avatar-placeholder { background-image: url('https://files.catbox.moe/n7fryv.png'); }\n\n/* --- 彼岸花样式 --- */\n.fuluoluo-dialogue-v4 .lycoris-container { position: absolute; top: -2px; right: 2px; width: 65px; height: 85px; pointer-events: none; z-index: 15; }\n.fuluoluo-dialogue-v4 .lycoris-flower {\n    position: absolute; width: 100%; height: 100%;\n    /* 【已修复】这里恢复了完整的SVG代码 */\n    background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 120 180%22 xmlns=%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cdefs%3E%3Cfilter id=%22lycoris-shadow%22%3E%3CfeDropShadow dx=%221%22 dy=%221%22 stdDeviation=%223%22 flood-color=%22%23800000%22 flood-opacity=%220.8%22%2F%3E%3C%2Ffilter%3E%3ClinearGradient id=%22lycoris-red%22 x1=%220%25%22 y1=%220%25%22 x2=%22100%25%22 y2=%22100%25%22%3E%3Cstop offset=%220%25%22 stop-color=%22%23d10023%22%2F%3E%3Cstop offset=%2250%25%22 stop-color=%22%23ff0033%22%2F%3E%3Cstop offset=%22100%25%22 stop-color=%22%23900018%22%2F%3E%3C%2FlinearGradient%3E%3C%2Fdefs%3E%3Cg transform=%22translate(60 90) scale(0.8)%22%3E%3Cg transform=%22translate(0, -5)%22%3E%3Ccircle cx=%220%22 cy=%220%22 r=%223.5%22 fill=%22%23ffcc00%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.9%22%2F%3E%3Ccircle cx=%220%22 cy=%220%22 r=%221.8%22 fill=%22%23ff9900%22 opacity=%220.9%22%2F%3E%3C%2Fg%3E%3Cg%3E%3Cpath d=%22M0,0 C 25,-45 60,-35 50,-15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C 35,-35 70,-5 60,15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C -25,-45 -60,-35 -50,-15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C -35,-35 -70,-5 -60,15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C 25,45 60,35 50,15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C -25,45 -60,35 -50,15%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C 0,55 35,55 15,35%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3Cpath d=%22M0,0 C 0,-55 -35,-55 -15,-35%22 stroke=%22url(%23lycoris-red)%22 stroke-width=%223.2%22 fill=%22none%22 filter=%22url(%23lycoris-shadow)%22 opacity=%220.95%22%2F%3E%3C%2Fg%3E%3Cg transform=%22rotate(15)%22%3E%3Cpath d=%22M0,0 C 15,25 40,20 30,5%22 stroke=%22%23ff3366%22 stroke-width=%222.2%22 fill=%22none%22 opacity=%220.8%22%2F%3E%3Cpath d=%22M0,0 C -15,25 -40,20 -30,5%22 stroke=%22%23ff3366%22 stroke-width=%222.2%22 fill=%22none%22 opacity=%220.8%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n    background-size: contain; background-repeat: no-repeat; transform: rotate(15deg); filter: drop-shadow(0 0 6px rgba(209, 0, 35, 0.4)); animation: lycoris-sway 5s ease-in-out infinite;\n}\n.fuluoluo-dialogue-v4 .enhanced-breathing-light, .fuluoluo-dialogue-v4 .breathing-halo, .fuluoluo-dialogue-v4 .breathing-pulse, .fuluoluo-dialogue-v4 .enhanced-particle { position: absolute; top: 47%; left: 50%; border-radius: 50%; transform: translate(-50%, -50%); }\n.fuluoluo-dialogue-v4 .enhanced-breathing-light { width: 18px; height: 18px; background: radial-gradient(circle, rgba(255, 0, 51, 0.8) 0%, rgba(209, 0, 35, 0.5) 40%, transparent 70%); z-index: 1; animation: enhanced-breathing 4s ease-in-out infinite; }\n.fuluoluo-dialogue-v4 .breathing-halo { width: 28px; height: 28px; background: radial-gradient(circle, rgba(255, 50, 100, 0.4) 0%, rgba(209, 0, 35, 0.3) 50%, transparent 80%); z-index: 0; animation: breathing-halo 6s ease-in-out infinite 0.8s; }\n.fuluoluo-dialogue-v4 .breathing-pulse { width: 12px; height: 12px; background: radial-gradient(circle, rgba(255, 100, 150, 0.7) 0%, rgba(255, 50, 100, 0.4) 60%, transparent 80%); z-index: 2; animation: breathing-pulse 3.5s ease-in-out infinite 0.4s; }\n.fuluoluo-dialogue-v4 .enhanced-particle { opacity: 0; z-index: 3; }\n.fuluoluo-dialogue-v4 .particle-1 { width: 2.5px; height: 2.5px; background: rgba(255, 0, 51, 0.9); box-shadow: 0 0 6px rgba(255, 0, 51, 0.9); animation: enhanced-particle-fall-1 4.5s ease-in-out infinite; }\n.fuluoluo-dialogue-v4 .particle-2 { width: 2px; height: 2px; background: rgba(255, 80, 120, 0.8); box-shadow: 0 0 5px rgba(255, 80, 120, 0.8); animation: enhanced-particle-fall-2 5.2s ease-in-out infinite 0.7s; }\n.fuluoluo-dialogue-v4 .particle-3 { width: 1.5px; height: 1.5px; background: rgba(255, 30, 60, 0.9); box-shadow: 0 0 5px rgba(255, 30, 60, 0.9); animation: enhanced-particle-fall-3 6s ease-in-out infinite 1.3s; }\n.fuluoluo-dialogue-v4 .particle-4 { width: 1.8px; height: 1.8px; background: rgba(255, 100, 140, 0.7); box-shadow: 0 0 4px rgba(255, 100, 140, 0.7); animation: enhanced-particle-fall-4 5.8s ease-in-out infinite 0.3s; }\n.fuluoluo-dialogue-v4 .particle-5 { width: 2.2px; height: 2.2px; background: rgba(255, 50, 90, 0.8); box-shadow: 0 0 7px rgba(255, 50, 90, 0.8); animation: enhanced-particle-fall-5 4.8s ease-in-out infinite 1.8s; }\n.fuluoluo-dialogue-v4 .particle-6 { width: 2px; height: 2px; background: rgba(255, 20, 40, 0.9); box-shadow: 0 0 6px rgba(255, 20, 40, 0.9); animation: enhanced-particle-fall-6 5.5s ease-in-out infinite 1.1s; }\n.fuluoluo-dialogue-v4 .particle-7 { width: 1.5px; height: 1.5px; background: rgba(255, 120, 160, 0.6); box-shadow: 0 0 3px rgba(255, 120, 160, 0.6); animation: enhanced-particle-fall-7 6.5s ease-in-out infinite 0.5s; }\n\n/* --- 响应式调整 (已加入新断点) --- */\n@media (max-width: 768px) {\n    .fuluoluo-dialogue-v4 { --fuluoluo-base-font-size: 12px; --fuluoluo-padding: 0.6em 0.8em; --fuluoluo-margin: 0.7em 0; }\n    .fuluoluo-dialogue-v4 .fuluoluo-body p { text-align: justify; line-height: 1.45; }\n    .fuluoluo-dialogue-v4 .lycoris-container { width: 55px; height: 70px; top: 1px; right: 1px; }\n}\n@media (max-width: 600px) {\n    .fuluoluo-dialogue-v4 .lycoris-container {\n        width: 48px; height: 60px;\n    }\n}\n@media (max-width: 480px) {\n    .fuluoluo-dialogue-v4 { --fuluoluo-base-font-size: 11px; }\n    .fuluoluo-dialogue-v4 .lycoris-container {\n        width: 40px; height: 50px;\n    }\n}\n\n/* --- 彼岸花动画 (无改动) --- */\n@keyframes lycoris-sway { 0%, 100% { transform: rotate(15deg) translateY(0) translateX(0); } 25% { transform: rotate(17deg) translateY(-1px) translateX(1px); } 50% { transform: rotate(15deg) translateY(1px) translateX(0); } 75% { transform: rotate(13deg) translateY(-1px) translateX(-1px); } }\n@keyframes enhanced-breathing { 0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.9); box-shadow: 0 0 8px rgba(255, 0, 51, 0.3); } 25% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); box-shadow: 0 0 12px rgba(255, 0, 51, 0.5); } 50% { opacity: 0.9; transform: translate(-50%, -50%) scale(1.2); box-shadow: 0 0 20px rgba(255, 0, 51, 0.7), 0 0 30px rgba(255, 0, 51, 0.4); } 75% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); box-shadow: 0 0 12px rgba(255, 0, 51, 0.5); } }\n@keyframes breathing-halo { 0%, 100% { opacity: 0.2; transform: translate(-50%, -50%) scale(1); filter: blur(1.5px); } 50% { opacity: 0.5; transform: translate(-50%, -50%) scale(1.3); filter: blur(2.5px); } }\n@keyframes breathing-pulse { 0%, 100% { opacity: 0.4; transform: translate(-50%, -50%) scale(0.8); } 50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 15px rgba(255, 100, 150, 0.6); } }\n@keyframes enhanced-particle-fall-1 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + 18px), calc(-50% + 30px)) rotate(150deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-2 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.8; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% - 12px), calc(-50% + 25px)) rotate(210deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-3 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + 10px), calc(-50% + 35px)) rotate(180deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-4 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.7; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% - 6px), calc(-50% + 32px)) rotate(270deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-5 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.8; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + 5px), calc(-50% + 28px)) rotate(90deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-6 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% - 15px), calc(-50% + 23px)) rotate(330deg) scale(0.3); } }\n@keyframes enhanced-particle-fall-7 { 0%, 15% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(calc(-50% + 8px), calc(-50% + 37px)) rotate(120deg) scale(0.3); } }\n</style>\n",
    "trimStrings": [],
    "placement": [
        2
    ],
    "disabled": false,
    "markdownOnly": true,
    "promptOnly": false,
    "runOnEdit": true,
    "substituteRegex": 0,
    "minDepth": null,
    "maxDepth": 8
}